From b24df3faeaf1c4c9e99b1545be11b2f2fee5b720 Mon Sep 17 00:00:00 2001
From: YukiLeafX <yukileafx@gmail.com>
Date: Sat, 16 May 2020 11:47:16 +0900
Subject: [PATCH] Don't save configuration files


diff --git a/src/main/java/com/destroystokyo/paper/PaperConfig.java b/src/main/java/com/destroystokyo/paper/PaperConfig.java
index d8b0a8688..cc0360660 100644
--- a/src/main/java/com/destroystokyo/paper/PaperConfig.java
+++ b/src/main/java/com/destroystokyo/paper/PaperConfig.java
@@ -107,8 +107,8 @@ public class PaperConfig {
         }
 
         try {
-            config.save(CONFIG_FILE);
-        } catch (IOException ex) {
+            // Yukkit - don't save paper.yml
+        } catch (Exception ex) { // Yukkit
             Bukkit.getLogger().log(Level.SEVERE, "Could not save " + CONFIG_FILE, ex);
         }
     }
diff --git a/src/main/java/net/minecraft/server/PropertyManager.java b/src/main/java/net/minecraft/server/PropertyManager.java
index 5055a4fb8..8288f656f 100644
--- a/src/main/java/net/minecraft/server/PropertyManager.java
+++ b/src/main/java/net/minecraft/server/PropertyManager.java
@@ -77,8 +77,7 @@ public class PropertyManager {
             }
             // CraftBukkit end
 
-            fileoutputstream = new FileOutputStream(this.file);
-            this.properties.store(fileoutputstream, "Minecraft server properties");
+            // Yukkit - don't save server.properties
         } catch (Exception exception) {
             PropertyManager.a.warn("Failed to save {}", this.file, exception);
             this.a();
diff --git a/src/main/java/org/bukkit/craftbukkit/CraftServer.java b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
index af4c369ca..e7b3ab2e6 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftServer.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
@@ -295,8 +295,8 @@ public final class CraftServer implements Server {
 
     private void saveConfig() {
         try {
-            configuration.save(getConfigFile());
-        } catch (IOException ex) {
+            // Yukkit - don't save bukkit.yml
+        } catch (Exception ex) { // Yukkit
             Logger.getLogger(CraftServer.class.getName()).log(Level.SEVERE, "Could not save " + getConfigFile(), ex);
         }
     }
diff --git a/src/main/java/org/spigotmc/SpigotConfig.java b/src/main/java/org/spigotmc/SpigotConfig.java
index 2cdd9aaf8..c790f1642 100644
--- a/src/main/java/org/spigotmc/SpigotConfig.java
+++ b/src/main/java/org/spigotmc/SpigotConfig.java
@@ -123,8 +123,8 @@ public class SpigotConfig
 
         try
         {
-            config.save( CONFIG_FILE );
-        } catch ( IOException ex )
+            // Yukkit - don't save spigot.yml
+        } catch ( Exception ex ) // Yukkit
         {
             Bukkit.getLogger().log( Level.SEVERE, "Could not save " + CONFIG_FILE, ex );
         }
-- 
2.26.2.windows.1

